<!DOCTYPE html>
<!--[if lt IE 7 ]><html class="ie ie6" lang="fr"> <![endif]-->
<!--[if IE 7 ]><html class="ie ie7" lang="fr"> <![endif]-->
<!--[if IE 8 ]><html class="ie ie8" lang="fr"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!--><html lang="fr"> <!--<![endif]-->
<head>

<!-- Extra Header for IPython Notebooks
================================================== -->

	<!-- Basic Page Needs
  ================================================== -->
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

  <title>A tutorial on optimization algorithms, example of PSO</title>

  <meta name="description" content="">
  <meta name="author" content="Mamady Nabé">
  <meta name="copyright" content="&copy; Copyright Mamady Nabé, 2018 ">

  <!-- Mobile Specific Metas
  ================================================== -->
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <!-- Fonts
  ================================================== -->
  <link href='http://fonts.googleapis.com/css?family=Open+Sans|Merriweather|Source+Code+Pro' rel='stylesheet' type='text/css'>
  <link href='https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css' rel='stylesheet' type='text/css'>

  <!-- CSS
  ================================================== -->
  <link rel="stylesheet" href="/theme/css/style.min.css?3246d842">
  <!-- Feeds
  ================================================== -->
  <!--   <link rel="alternate" type="application/atom+xml" href="http://mamadyonline.github.io/feeds/all.atom.xml" title="Mamady Nabé Full Atom Feed">
 -->

	<!-- Facebook Open Graph
  ================================================== -->
  <meta property="og:type" content="website">
  <meta property="og:title" content="A tutorial on optimization algorithms, example of PSO">
  <meta property="og:url" content="http://mamadyonline.github.io/a-tutorial-on-optimization-algorithms-example-of-pso-en.html">
  <meta property="og:description" content="">
  <meta property="og:site_name" content="Mamady Nabé">
  <meta property="og:image" content="http://mamadyonline.github.io">

  <!-- Twitter Cards
  ================================================== -->
  <meta name="twitter:card" content="summary">
  <meta name="twitter:site" content="@MamadyNabeke">
  <meta name="twitter:creator" content="@MamadyNabeke">
  <meta name="twitter:domain" content="mamadyonline.github.io">
  <meta name="twitter:image" content="http://mamadyonline.github.io/theme/static/images/logo.png">
  <meta name="twitter:title" content="A tutorial on optimization algorithms, example of PSO">
  <meta name="twitter:description" content="">

	<!--[if lt IE 9]>
		<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->


	<!-- Favicons
	================================================== -->
	<!-- <link rel="shortcut icon" href=""> -->
	<link rel="apple-touch-icon" href="/theme/static/images/apple-touch-icon.png">
	<link rel="apple-touch-icon" sizes="72x72" href="/theme/static/images/apple-touch-icon-72x72.png">
	<link rel="apple-touch-icon" sizes="114x114" href="/theme/static/images/apple-touch-icon-114x114.png">

</head>
<body>
	<!-- Primary Page Layout
	================================================== -->
	<div class="container">
<!-- Navigation
================================================== -->
<nav class="navbar">
  <div class="navbar-brand six columns">
      <ul>
        <!-- <li>
          <a href="/" title="Accueil"><img id="logo" src="/theme/static/images/logo.png" alt="Mamady Nabé"></a>
        </li>
        <li> -->
          <h1><a href="/" title="Accueil">Mamady Nabé</a></h1>
        </li>
      </ul>
      <ul id="social-icons">
        <li>
          <a class="icon" href="https://twitter.com/MamadyNabeke" title="Twitter">
            <i class="fa fa-twitter"></i>
          </a>
        </li>
        <li>
          <a class="icon" href="https://github.com/mamadyonline" title="Github">
            <i class="fa fa-github"></i>
          </a>
        </li>
        <li>
          <a class="icon" href="http://linkedin.com/in/mamady" title="Linkedin">
            <i class="fa fa-linkedin"></i>
          </a>
        </li>
        <li>
          <a class="icon" href="https://fr.quora.com/profile/Mamady-Nab%C3%A9" title="Quora">
            <i class="fa fa-quora"></i>
          </a>
        </li>

        <li>
          <a class="icon" href="mailto:mamady.nabe@outlook.com" title="Email">
            <i class="fa fa-envelope-o"></i>
          </a>
        </li>
      </ul> <!-- End social-icons ul -->
    </div> <!-- End navbar-brand -->

  <div class="navbar-links">
      <ul>
        <li><a href="/nouvelles/">Nouvelles</a></li>
        <li><a href="/blog/">Blog</a></li>
      </ul> <!-- End navbar-links ul -->
    </div> <!-- End navbar-links -->
</nav> <!-- End navbar -->		<section id="content" class="twelve columns">

  <!-- Article Headers
  ================================================================== -->
  <h1 class="article-title"><a href="/a-tutorial-on-optimization-algorithms-example-of-pso-en.html" title="Permalink to A tutorial on optimization algorithms, example of PSO">A tutorial on optimization algorithms, example of PSO</a></h1>
  <h5 class="article-date">novembre 05, 2018
 | Tags:         <a class="tag" href="/tag/optimization.html" rel="tag" title="Posts tagged with ">optimization</a>
        <a class="tag" href="/tag/algorithms.html" rel="tag" title="Posts tagged with ">algorithms</a>
        <a class="tag" href="/tag/machine-learning.html" rel="tag" title="Posts tagged with ">machine learning</a>
        <a class="tag" href="/tag/data-science.html" rel="tag" title="Posts tagged with ">data science</a>
  </h5>
  <hr class="small"></hr>

  <!-- Article Content
  ================================================================== -->
  <div class="article-content">
    <p>This will be my first technical article for my blog. The idea is to start a series of tutorials about optimization algorithms. In this post, I'll make a quick introduction to what is an optimization algorithm and then I'll talk about one specific that is, Particle Swarm Optimization (PSO).</p>
<h2>What is an optimization algorithm ?</h2>
<p>Optimization algorithms are here to solve optimization problems where we want to find the best solution within a large set of possible solutions.</p>
<p>Optimization problems are everywhere. For instance, when we enter a super market, the goal is to purchase all the things we need in a short time and with little expenses. Doing so we are optimizing our time and our budget.</p>
<p>We can define an optimization problem by three things:</p>
<ul>
<li>The measure of success (technically the <strong><em>cost function</em></strong>) which will be maximized or minimized.</li>
<li>Instances of the problem which are the possible <strong><em>inputs</em></strong> to the problem, expressed in terms of <strong><em>design variables</em></strong>. These Instances can be subject to some <strong><em>constraints</em></strong>, thus setting bounds on the possible values to explore.</li>
<li>The set of possible solutions which define the <strong><em>space to explore</em></strong> in order to find the best solution.</li>
</ul>
<p>Generally, exploring the set of solutions is computationally heavy and very time consuming, that is why there are various algorithms to tackle these problems and find an appropriate and acceptable solution in a reasonable time.</p>
<p>These algorithms are iterative, and according to some criteria, one can decide whether the solution found is good enough to stop the optimization process. When that is possible, we speak about the algorithm <strong><em>convergence</em></strong>.</p>
<p>One of these algorithms is the Particle Swarm Optimization (PSO), which is the subject of this post. First, I'll try to explain how it works, then I'll walk you through a <strong><em>Python</em></strong> implementation, and test it on a real example.</p>
<h2>What is Particle Swarm Optimization (PSO)?</h2>
<p>PSO is an iterative optimization algorithm which tries to simulate social behaviour. It was developped by Dr. Eberhart and Dr. Kennedy, back in 1995.</p>
<p>It is best known that working together in order to achieve a goal is more efficient than no team work at all. PSO leverages this social behaviour by prevailing the information sharing between a set of possible candidate solutions, each called a particle.</p>
<p>A particle is defined by:</p>
<ul>
<li>A position. For example when the design variables are limited to two (i.e plane), a particle is defined by its coordinate (x,y).</li>
<li>A velocity. This is a value used to move the particle position toward the best solution.</li>
</ul>
<p>The information sharing is performed in two ways, giving two variants of PSO:</p>
<ul>
<li>Local PSO, in which the information sharing is between every particle and its direct neighbors. Here a particle's movement, at each iteration, is influenced by its local best known position. The particle and its neighbors form a <strong>ring data structure topology</strong>.</li>
<li>Gloabl PSO, where the information sharing is between every particle and the best particle of all, defined by the best position. It is the best position which guides the movements of all the other particles, at each iteration. Here the particles are organized in a <strong>star data structure topology</strong>.</li>
</ul>
<table>
<thead>
<tr>
<th align="center">Local PSO</th>
<th align="center">Global PSO</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><img alt="Local PSO data structure" src="/images/pso-ring.png"></td>
<td align="center"><img alt="Global PSO data structure" src="/images/pso-star.png"></td>
</tr>
</tbody>
</table>
<p>Now that we understand how it works. Let's see the algorithm.</p>
<h2>The Algorithm</h2>
<!-- ![PSO in action](/images/pso.gif) -->

<p>We start by initializing randomly a population of particles in the search space. And through various iterations, each particle moves toward the best solution by following either the global best solution at each iteration or its locally best-known solution among its neighbors, depending on whether we consider local or global PSO.</p>
<p>Here is the pseudo-code for global PSO:</p>
<div class="highlight"><pre><span></span>For each particle
    Randomly initialize its position and velocity
END
Do
  For each particle
      Calculate its fitness value (measure of success)
      If the fitness value is better than the best fitness value (pBest) in history
            Set current value as the new pBest
  END

  Choose the particle with the best fitness value of all the particles as the gBest
  For each particle
      Calculate particle velocity
      Update particle position using the computed velocity
  End
While maximum iterations or minimum error criteria is not attained
</pre></div>


<h2>Python Implementation</h2>
<p>The points to discuss here are the the initializations of the particle and their updates, both for the positions and the velocities.</p>
<ul>
<li>Particles are initialized randomly using a uniform distribution.</li>
<li>The updates are performed using a slightly modified version of the initial paper, by the same authors (For further reading, go check this paper <a href="http://www.softcomputing.net/nabic11_7.pdf">Inertia weight strategies in PSO</a>).</li>
</ul>
<p>Here is the python code which tries to implement a simple PSO:</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="k">class</span> <span class="nc">PSO</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class implementing PSO algorithm.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">init_pos</span><span class="p">,</span> <span class="n">n_particles</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Initialize the key variables.</span>

<span class="sd">      Args:</span>
<span class="sd">        func (function): the fitness function to optimize.</span>
<span class="sd">        init_pos (array-like): the initial position to kick off the</span>
<span class="sd">                               optimization process.</span>
<span class="sd">        n_particles (int): the number of particles of the swarm.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">func</span> <span class="o">=</span> <span class="n">func</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">n_particles</span> <span class="o">=</span> <span class="n">n_particles</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">init_pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">init_pos</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">particle_dim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">init_pos</span><span class="p">)</span>
    <span class="c1"># Initialize particle positions using a uniform distribution</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">particles_pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">n_particles</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">particle_dim</span><span class="p">))</span> \
                        <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">init_pos</span>
    <span class="c1"># Initialize particle velocities using a uniform distribution</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">velocities</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">n_particles</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">particle_dim</span><span class="p">))</span>

    <span class="c1"># Initialize the best positions</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">g_best</span> <span class="o">=</span> <span class="n">init_pos</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">p_best</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">particles_pos</span>

  <span class="k">def</span> <span class="nf">update_position</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Update particle position.</span>

<span class="sd">      Args:</span>
<span class="sd">        x (array-like): particle current position.</span>
<span class="sd">        v (array-like): particle current velocity.</span>

<span class="sd">      Returns:</span>
<span class="sd">        The updated position (array-like).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
    <span class="n">new_x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">v</span>
    <span class="k">return</span> <span class="n">new_x</span>

  <span class="k">def</span> <span class="nf">update_velocity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">p_best</span><span class="p">,</span> <span class="n">g_best</span><span class="p">,</span> <span class="n">c0</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">c1</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="mf">0.75</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Update particle velocity.</span>

<span class="sd">      Args:</span>
<span class="sd">        x (array-like): particle current position.</span>
<span class="sd">        v (array-like): particle current velocity.</span>
<span class="sd">        p_best (array-like): the best position found so far for a particle.</span>
<span class="sd">        g_best (array-like): the best position regarding</span>
<span class="sd">                             all the particles found so far.</span>
<span class="sd">        c0 (float): the cognitive scaling constant.</span>
<span class="sd">        c1 (float): the social scaling constant.</span>
<span class="sd">        w (float): the inertia weight</span>

<span class="sd">      Returns:</span>
<span class="sd">        The updated velocity (array-like).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">v</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="s1">&#39;Position and velocity must have same shape&#39;</span>
    <span class="c1"># a random number between 0 and 1.</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">()</span>
    <span class="n">p_best</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">p_best</span><span class="p">)</span>
    <span class="n">g_best</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">g_best</span><span class="p">)</span>

    <span class="n">new_v</span> <span class="o">=</span> <span class="n">w</span><span class="o">*</span><span class="n">v</span> <span class="o">+</span> <span class="n">c0</span> <span class="o">*</span> <span class="n">r</span> <span class="o">*</span> <span class="p">(</span><span class="n">p_best</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">c1</span> <span class="o">*</span> <span class="n">r</span> <span class="o">*</span> <span class="p">(</span><span class="n">g_best</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">new_v</span>

  <span class="k">def</span> <span class="nf">optimize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maxiter</span><span class="o">=</span><span class="mi">200</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Run the PSO optimization process untill the stoping criteria is met.</span>
<span class="sd">      Case for minimization. The aim is to minimize the cost function.</span>

<span class="sd">      Args:</span>
<span class="sd">          maxiter (int): the maximum number of iterations before stopping</span>
<span class="sd">                         the optimization.</span>

<span class="sd">      Returns:</span>
<span class="sd">          The best solution found (array-like).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">maxiter</span><span class="p">):</span>
      <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_particles</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">particles_pos</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">velocities</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">p_best</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_best</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">velocities</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_velocity</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">p_best</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">g_best</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">particles_pos</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_position</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
        <span class="c1"># Update the best position for particle i</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">particles_pos</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">(</span><span class="n">p_best</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">p_best</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">particles_pos</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="c1"># Update the best position overall</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">particles_pos</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">g_best</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">g_best</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">particles_pos</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">g_best</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">g_best</span><span class="p">)</span>
</pre></div>


<p>We can test it on the sphere function, for example.</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sphere</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      In 3D: f(x,y,z) = x² + y² + z²</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

<span class="c1"># If there is a main put this in the main</span>
<span class="n">init_pos</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">PSO_s</span> <span class="o">=</span> <span class="n">PSO</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="n">sphere</span><span class="p">,</span> <span class="n">init_pos</span><span class="o">=</span><span class="n">init_pos</span><span class="p">,</span> <span class="n">n_particles</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">res_s</span> <span class="o">=</span> <span class="n">PSO_s</span><span class="o">.</span><span class="n">optimize</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;Sphere function&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;x = {res_s[0]}&#39;</span><span class="p">)</span> <span class="c1"># x = [-0.00025538 -0.00137996  0.00248555]</span>
<span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;f = {res_s[1]}&#39;</span><span class="p">)</span> <span class="c1"># f = 8.14748063004205e-06</span>
</pre></div>


<h2>Some points to discuss</h2>
<ol>
<li>The initial point matters a lot in the performance of the optimization algorithm. As a rule of thumbs, as far as it is from the optmum, as long it takes the algorithm to converge (this is true for all optimization algorithms).</li>
<li>PSO is a stochastic algorithm, the updates are performed using random processes. This can make it hard to track the solutions for multiple optimizatiion processes run. We can always use a seed for the random numbers though.</li>
<li>It does not absolutely find the global optimal solution, but it does a good job finding one which is very close. For the sphere function, the global optimum is at (0, 0, 0), my implementation found another point which is not too bad.</li>
<li>Depending on the number of particles, the convergence might take longer. Generally, it is better not to go beyong 50.</li>
<li>For difficult functions, we might need more iterations before being able to find a good solution, between 500 and 1000 iterations.</li>
</ol>
<p>This is the end of this long post. I hope it helps, I tried my best to keep it simple.</p>
<p>For a more advanced PSO, I highly recommend this open source python library <a href="https://github.com/mamadyonline/pyswarms">Pyswarms</a>. You can also find all the code on my github at <a href="https://github.com/mamadyonline/Optimization-algorithm-tutorials">My simple implementation</a>.</p>
<h2>Reference:</h2>
<ul>
<li><a href="http://www.swarmintelligence.org/tutorials.php">Swarm intelligence</a></li>
<li><a href="http://www.softcomputing.net/nabic11_7.pdf">Inertia weight strategies in PSO</a></li>
</ul>
  </div>

  <hr class="small"></hr>
  <div class="article-sharing">
      <ul>
      <!-- Twitter Sharing
      ================================================================== -->
      <li><a href="https://twitter.com/share" class="twitter-share-button" data-via="MamadyNabeke">Tweet</a></li>

      <!-- Facebook Sharing
      ================================================================== -->
      <li><div class="fb-share-button"
          data-href="http://mamadyonline.github.io/a-tutorial-on-optimization-algorithms-example-of-pso-en.html"
          data-layout="button_count">
      </div></li>
      </ul>
    </div>

    <!-- Back to home
    ================================================================== -->
    <div class="back-to-home">
      <a href="/">← Aller à l'accueil</a>
    </div>
    <hr class="small"></hr>
  </div>
		</section>
<!-- Navigation
================================================== -->
<footer class="twelve columns">
	<!-- <hr class="small"> -->
  <p>Généré avec <a href="http://getpelican.com">Pelican</a>. Thème void par <a href="https://github.com/gjreda/void">Greg Reda</a></p>
  <p>&copy; Copyright Mamady Nabé, 2018</p>
</footer>	</div><!-- container -->

<!-- Google Analytics
================================================== -->
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-116900970-1']);
  _gaq.push(['_setDomainName', 'mamadyonline.github.io']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

  <script type="text/javascript">
    $("a").on('click', function(e) {
      var url = $(this).attr("href");
      console.log(url);
      if (e.currentTarget.host != window.location.host) {
        _gaq.push(['_trackEvent', 'Outbound Links', e.currentTarget.host, url, 0]);
        if (e.metaKey || e.ctrlKey) {
          var newtab = true;
        }
        if (!newtab) {
          e.preventDefault();
          setTimeout('document.location = "' + url + '"', 100);
        }
      }
    });
  </script>
</body> <!-- End body -->

<!-- JavaScript
=================================================== -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
<script type="text/javascript" async src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

<!-- twitter.js
==================================================================== -->
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>

<!-- Facebook SDK for JS
==================================================================== -->
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.3";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>


</html>